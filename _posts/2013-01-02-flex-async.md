---
author: lieeGin
comments: true
date: 2013-01-02 10:39:45+00:00
layout: post
slug: flex-async
title: flex的异步机制
wordpress_id: 701
categories:
- 前端/应用开发
---

其实我写这个也不是说想要详细去说flex的异步机制原理，大家都明白这个异步机制是什么。我只是说一下我在工作中遇到的一些情况，以及是如何解决问题的。

首先从我的需求开始说，我需要做一个提交验证，那个模块的数据是一个一对多的关系，一条主表数据可以对应多条从表数据，提交时需要对每条从表数据的某个字段进行验证。但是这个验证需要与数据库里的其他数据进行计算才知道验证是否通过。

那么我首先想到的是，在提交方法中将数据提交到后台进行验证，只需要后台返回是否验证通过的结果，不通过则弹出alert，根据用户选择来确定是否继续往下执行。每次前台往后台发送的数据就是一条从表数据，有多少条就发多少次请求，循环调用完验证方法之后直接提交。好吧，以前的确是没有这个意识，代码完成后测试发现，返回验证结果不管通过不通过，提交代码都执行了。这时我才想到了异步这个问题，而且flex的alert也是异步的，弹出提示框之后，不会等待用户选择，也会直接执行下面的代码。这一点好像有点小纠结。

想了想，那么就只好用flex的各种listener了，首先为远程调用service注册各种成功和失败事件方法。在这些方法中写接下来要执行的操作，其实就是callback。那么这里有第二个细节，因为我需要验证的有可能是多条数据，每次只能验证一条，所以流程应该是这样：验证第一条数据，通过，验证第二条；不通过，弹出提示，如果用户选择继续执行，则也验证第二条；否则返回。那么这就用到了一下递归，其实算不上严谨的递归吧，是在验证方法返回的监听事件中，判断条件后再调用验证。

整体解决方法就是找这个思路做。其他就是一些判断什么的，就不多说了。这也没什么技术的东西，其实就是记录一下，让自己更有印象，以后会记得清楚些。
